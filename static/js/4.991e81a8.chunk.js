(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{132:function(t,e,a){t.exports=a.p+"static/media/characters.111f6faf.png"},133:function(t,e,a){t.exports=a.p+"static/media/world.74af39e9.png"},134:function(t,e,a){t.exports=a.p+"static/media/world.db6fb586.xml"},135:function(t,e,a){var n={"./PalletTown.xml":[136,5],"./PalletTownRooms.xml":[137,6]};function i(t){if(!a.o(n,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],i=e[0];return a.e(e[1]).then((function(){return a.t(i,7)}))}i.keys=function(){return Object.keys(n)},i.id=135,t.exports=i},138:function(t,e,a){"use strict";a.r(e),a.d(e,"createGame",(function(){return D}));var n=a(115),i=a(18),r=a(15),l=a(35),o={meta:{},frames:{stillDown:{frame:{x:96,y:224,w:16,h:16}},walkDown0:{frame:{x:16,y:240,w:16,h:16}},walkDown1:Object(l.a)({frame:{x:16,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL),stillUp:{frame:{x:112,y:224,w:16,h:16}},walkUp0:{frame:{x:32,y:240,w:16,h:16}},walkUp1:Object(l.a)({frame:{x:32,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL),stillLeft:{frame:{x:0,y:240,w:16,h:16}},walkLeft:{frame:{x:48,y:240,w:16,h:16}},stillRight:Object(l.a)({frame:{x:0,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL),walkRight:Object(l.a)({frame:{x:48,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL)},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}},s=a(132),c=a.n(s),u=a(51),p="still",d="walk";function f(t,e){return t.data.animations[e].map((function(e){var a,n=t.textures[e];return n.rotate=null!==(a=t.data.frames[e].rotate)&&void 0!==a?a:n.rotate,n}))}function w(t){var e={game:t,update:function(){var t=e.direction===i.a.RIGHT?1:e.direction===i.a.LEFT?-1:0,a=e.direction===i.a.DOWN?1:e.direction===i.a.UP?-1:0;e.state!==d||e.speed.x||e.speed.y||function(t,a){var n=Math.floor(e.position.x/i.b+t),r=Math.floor(e.position.y/i.b+a);if(e.nextTile.x===n&&e.nextTile.y===r)return;e.nextTile={x:n,y:r,data:e.game.world.tileAt(n,r)}}(t,a);e.state!==d||e.speed.x||e.speed.y||"false"!==e.nextTile.data.collision?e.speed.x||e.speed.y?w(e.speed.x?"x":"y"):s():(e.speed.x=t,e.speed.y=a,w(e.speed.x?"x":"y",!0));!function(){if(!e.sprite)return;var t=e.textures[e.state+Object(u.c)(e.direction)];if(!t||e.sprite.textures===t)return;e.sprite.textures=t,e.sprite.play()}()},still:a,walk:l,sprite:null,state:null,direction:i.a.DOWN,nextDirection:null,position:{x:3*i.b,y:7*i.b},speed:{x:0,y:0},nextTile:{data:{}},textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function a(){e.state=p}function l(t){e.direction===t||e.state===d?(e.nextDirection=t,e.state=d):function(t){setTimeout((function(){e.direction=t,t===e.game.action?l(t):a()}),100)}(t)}function s(){e.nextDirection&&(e.direction=e.nextDirection,e.nextDirection=null)}function w(t,a){if(e.speed[t]){var n=e.speed[t]*i.c,l=Math.abs(e.position[t]%i.b),o=l&&(1===e.speed[t]?l:i.b-l);if(l){var c=e.position[t]<=0?o:i.b-o;e.position[t]+=c>=i.c?n:c*e.speed[t]}else if(a)e.position[t]+=n;else{e.speed[t]=0,s();var u=e.nextTile.data;if(u.location||u.layer){var p=u.position.split(","),d=Object(r.a)(p,2),f=d[0],w=d[1];e.game.world.setLocation(u.location,u.layer,{x:f*i.b,y:w*i.b+i.b})}}}}return(new n.e).add("characters",c.a).load((function(t,a){var r=new n.g(a.characters.texture,o);r.parse((function(){e.textures.stillDown=[r.textures.stillDown],e.textures.stillUp=[r.textures.stillUp],e.textures.stillLeft=[r.textures.stillLeft],e.textures.stillRight=[r.textures.stillRight],e.textures.walkDown=f(r,"walkDown"),e.textures.walkUp=f(r,"walkUp"),e.textures.walkLeft=f(r,"walkLeft"),e.textures.walkRight=f(r,"walkRight");var t=new n.a(e.textures["still".concat(Object(u.c)(e.direction))]);t.width=i.b,t.height=i.b,t.animationSpeed=.1,t.x=e.game.app.screen.width/2-t.width/2,t.y=e.game.app.screen.height/2-t.height/2,e.sprite=t,e.game.app.stage.addChild(t)}))})),e}var x=a(46),h=a(34),m=a.n(h),y=a(47),b=a(133),v=a.n(b),k=a(134),g=a.n(k);function O(){return new Promise((function(t){(new n.e).add("world",v.a).load((function(e,a){t(a.world.texture)}))}))}function R(t){var e=t.texture,a=t.map,r=t.tileX,l=t.tileY,o=t.x,s=t.y,c=t.object,u=t.tileSize,p=new n.d;p.name="".concat(o,"-").concat(s),p.data=c,p.beginTextureFill({texture:e}),p.drawRect(r,l,u,u),p.width=i.b,p.height=i.b,p.x=-r*p.scale.x+o*i.b,p.y=-l*p.scale.y+s*i.b,a.addChild(p)}function D(t){n.j.skipHello(),n.i.SCALE_MODE=n.f.NEAREST;var e={app:null,action:null,player:null,world:null,enableControls:!1};e.app=new n.b({view:t,width:1920,height:1080}),e.player=w(e),e.world=function(t){var e={game:t,update:function(){var t,a,n=e.game.player.position;e.camera.pivot.x=-(null===(t=e.game.player.sprite)||void 0===t?void 0:t.x),e.camera.pivot.y=-(null===(a=e.game.player.sprite)||void 0===a?void 0:a.y),e.camera.position.x=-n.x,e.camera.position.y=-n.y},tileAt:function(t,a){var n;return e.camera.children.length&&(null===(n=e.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(a)))||void 0===n?void 0:n.data)||{}},setLocation:function(t,a,n){e.location=t||e.location,e.layer=a,l(n)},location:"PalletTownRooms",layer:"house1 f2",texture:null,data:null,map:{},camera:new n.c};function i(){return(i=Object(y.a)(m.a.mark((function t(){var a,n,i,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([O(),Object(u.a)(g.a)]);case 2:return a=t.sent,n=Object(r.a)(a,2),i=n[0],o=n[1],e.texture=i,e.data=o,t.next=10,l();case 10:e.game.enableControls=!0;case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(t){return o.apply(this,arguments)}function o(){return(o=Object(y.a)(m.a.mark((function t(i){var r,l,o,s,c,p,d,f,w,h,y,b;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.location,l=e.layer||"index",o=e.map[r+l]){t.next=17;break}return o=new n.c,t.next=7,a(135)("./".concat(r,".xml"));case 7:return s=t.sent,c=s.default,t.next=11,Object(u.b)(c);case 11:p=t.sent,d=e.data,f=d.tileSize,w=d.columns,h=p[l],y=h.value,b=h.objects,y.split("\n").forEach((function(t,a){return t.split(",").forEach((function(t,n){if(t&&"0"!==t){var i=parseInt(t,10)-1,r=e.data[i]||{},l=i%w*f,s=Math.floor(i/w)*f;R({texture:e.texture,map:o,tileX:l,tileY:s,x:n,y:a,tileSize:f,object:r})}}))})),b.forEach((function(t){var a=parseInt(t.id,10)-1,n=a%w*f,i=Math.floor(a/w)*f;R({texture:e.texture,map:o,tileX:n,tileY:i,x:t.x/f,y:t.y/f,tileSize:f,object:Object(x.a)({},e.data[a]||{},{},t)})})),e.map[r+l]=o;case 17:e.camera.removeChildren(),e.camera.addChild(o),i&&(e.game.player.position=i);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){i.apply(this,arguments)}(),t.app.stage.addChildAt(e.camera,0),e}(e),window.addEventListener("action",(function(t){var a=t.detail;if(e.enableControls)switch(e.action=a,e.action){case i.a.UP:case i.a.LEFT:case i.a.RIGHT:case i.a.DOWN:e.player.walk(e.action);break;default:e.player.still()}})),e.app.ticker.add((function(){e.player.update(),e.world.update()}))}}}]);
//# sourceMappingURL=4.991e81a8.chunk.js.map