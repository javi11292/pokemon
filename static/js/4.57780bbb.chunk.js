(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{141:function(t,e,a){t.exports=a.p+"static/media/characters.111f6faf.png"},142:function(t,e,a){t.exports=a.p+"static/media/world.74af39e9.png"},143:function(t,e,a){t.exports=a.p+"static/media/world.db6fb586.xml"},144:function(t,e,a){var n={"./PalletTown.xml":[145,5],"./PalletTownRooms.xml":[146,6]};function i(t){if(!a.o(n,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],i=e[0];return a.e(e[1]).then((function(){return a.t(i,7)}))}i.keys=function(){return Object.keys(n)},i.id=144,t.exports=i},147:function(t,e,a){"use strict";a.r(e),a.d(e,"createGame",(function(){return U}));var n=a(24),i=a.n(n),r=a(37),l=a(123),o=a(12),s=a(127),c=a.n(s),u=c.a.createInstance({name:"player"}),p=a(51),d=a(10),f=a(49),x=a(36),w={PLAYER:[6,14]};function m(t){return{x:t%8*16,y:16*Math.floor(t/8),w:16,h:16}}var h=a(141),y=a.n(h),b="still",g="walk";function v(t,e){return t.data.animations[e].map((function(e){var a,n=t.textures[e];return n.rotate=null!==(a=t.data.frames[e].rotate)&&void 0!==a?a:n.rotate,n}))}function k(t,e){var a=function(t){var e=0,a=0,n={get x(){return e},set x(a){e=a,t.setItem("position",Object(f.a)({},n,{x:e}))},get y(){return a},set y(e){a=e,t.setItem("position",Object(f.a)({},n,{y:a}))}};return n}(c.a.createInstance({name:e})),n={game:t,still:function(){n.nextState=b},face:i,walk:function(t){i(t),n.nextState=g},sprite:null,state:b,direction:o.a.DOWN,speed:{x:0,y:0},nextDirection:null,nextState:null,nextTile:{data:{}},get position(){return a},set position(t){a.x=t.x,a.y=t.y},textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function i(t){n.nextDirection=t}function r(t,e){if(n.speed[t]){var a=n.speed[t]*o.c;if(n.position[t]%o.b||e)n.position[t]+=a;else{n.speed[t]=0,s();var i=n.nextTile.data;if(i.location||i.layer){var r=i.position.split(","),l=Object(d.a)(r,2),c=l[0],u=l[1];n.game.world.setLocation(i.location,i.layer,{x:c*o.b,y:u*o.b+o.b})}}}}function s(){n.nextDirection&&(n.direction=n.nextDirection,n.nextDirection=null),n.nextState&&(n.state=n.nextState,n.nextState=null)}return(new l.e).add("characters",y.a).load((function(t,a){var i=new l.g(a.characters.texture,function(t){var e=Object(d.a)(t,2),a=e[0],n=8*e[1]+a;return{meta:{},frames:{stillDown:{frame:m(n)},stillUp:{frame:m(n+1)},stillLeft:{frame:m(n+2)},stillRight:Object(x.a)({frame:m(n+2)},"rotate",l.h.MIRROR_HORIZONTAL),walkDown0:{frame:m(n+3)},walkDown1:Object(x.a)({frame:m(n+3)},"rotate",l.h.MIRROR_HORIZONTAL),walkUp0:{frame:m(n+4)},walkUp1:Object(x.a)({frame:m(n+4)},"rotate",l.h.MIRROR_HORIZONTAL),walkLeft:{frame:m(n+5)},walkRight:Object(x.a)({frame:m(n+5)},"rotate",l.h.MIRROR_HORIZONTAL)},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}}}(w[e.toUpperCase()]));i.parse((function(){n.textures.stillDown=[i.textures.stillDown],n.textures.stillUp=[i.textures.stillUp],n.textures.stillLeft=[i.textures.stillLeft],n.textures.stillRight=[i.textures.stillRight],n.textures.walkDown=v(i,"walkDown"),n.textures.walkUp=v(i,"walkUp"),n.textures.walkLeft=v(i,"walkLeft"),n.textures.walkRight=v(i,"walkRight");var t=new l.a(n.textures[n.state+Object(p.d)(n.direction)]);t.width=o.b,t.height=o.b,t.animationSpeed=.1,t.x=n.game.app.screen.width/2-t.width/2,t.y=n.game.app.screen.height/2-t.height/2,n.sprite=t,n.game.app.stage.addChild(t)}))})),n.game.app.ticker.add((function(){var t=n.direction===o.a.RIGHT?1:n.direction===o.a.LEFT?-1:0,e=n.direction===o.a.DOWN?1:n.direction===o.a.UP?-1:0;n.state!==g||n.speed.x||n.speed.y||function(t,e){var a=Math.floor(n.position.x/o.b+t),i=Math.floor(n.position.y/o.b+e);if(n.nextTile.x===a&&n.nextTile.y===i)return;n.nextTile={x:a,y:i,data:n.game.world.tileAt(a,i)}}(t,e),n.state!==g||n.speed.x||n.speed.y||"false"!==n.nextTile.data.collision?n.speed.x||n.speed.y?r(n.speed.x?"x":"y"):s():(n.speed.x=t,n.speed.y=e,r(n.speed.x?"x":"y",!0)),function(){if(!n.sprite)return;var t=n.textures[n.state+Object(p.d)(n.direction)];if(!t||n.sprite.textures===t)return;n.sprite.textures=t,n.sprite.play()}()})),n}var O=a(142),R=a.n(O),D=a(143),j=a.n(D);function I(){return new Promise((function(t){(new l.e).add("world",R.a).load((function(e,a){t(a.world.texture)}))}))}function L(t){var e=t.texture,a=t.map,n=t.tileX,i=t.tileY,r=t.x,s=t.y,c=t.object,u=t.tileSize,p=new l.d;p.name="".concat(r,"-").concat(s),p.data=c,p.beginTextureFill({texture:e}),p.drawRect(n,i,u,u),p.width=o.b,p.height=o.b,p.x=-n*p.scale.x+r*o.b,p.y=-i*p.scale.y+s*o.b,a.addChild(p)}function T(t,e){l.j.skipHello(),l.i.SCALE_MODE=l.f.NEAREST,t.app=new l.b({view:e,width:1920,height:1080}),t.app.renderer.plugins.accessibility.destroy(),delete t.app.renderer.plugins.accesibility,t.player=function(t){var e=k(t,"player"),a=e.walk,n=e.face,i=e.still;e.still=function(){i(),clearTimeout(r)},e.face=l,e.walk=o;var r=null;function l(t){n(t),r=setTimeout((function(){return o(t)}),50)}function o(t){e.direction!==t&&e.state!==g?l(t):a(t)}return e}(t),t.world=function(t){var e=null,n=null,o={game:t,update:s,tileAt:function(t,e){var a;return o.camera.children.length&&(null===(a=o.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(e)))||void 0===a?void 0:a.data)||{}},setLocation:function(t,e,a){o.location=t||o.location,o.layer=e||"index",u.setItem("location",o.location),u.setItem("layer",o.layer),x(a)},load:function(){return c.apply(this,arguments)},get location(){return e},set location(t){e=t,u.setItem("location",t)},get layer(){return n},set layer(t){n=t,u.setItem("layer",t)},texture:null,data:null,map:{},camera:new l.c};function s(){var t,e,a=o.game.player.position;o.camera.pivot.x=-(null===(t=o.game.player.sprite)||void 0===t?void 0:t.x),o.camera.pivot.y=-(null===(e=o.game.player.sprite)||void 0===e?void 0:e.y),o.camera.position.x=-a.x,o.camera.position.y=-a.y}function c(){return(c=Object(r.a)(i.a.mark((function t(){var e,a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([I(),Object(p.b)(j.a)]);case 2:return e=t.sent,a=Object(d.a)(e,2),n=a[0],r=a[1],o.texture=n,o.data=r,t.next=10,x();case 10:o.game.enableControls=!0;case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t){return w.apply(this,arguments)}function w(){return(w=Object(r.a)(i.a.mark((function t(e){var n,r,s,c,u,d,x,w,m,h,y,b;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.location,r=o.layer,s=o.map[n+r]){t.next=16;break}return s=new l.c,t.next=6,a(144)("./".concat(n,".xml"));case 6:return c=t.sent,u=c.default,t.next=10,Object(p.c)(u);case 10:d=t.sent,x=o.data,w=x.tileSize,m=x.columns,h=d[r],y=h.value,b=h.objects,y.split("\n").forEach((function(t,e){return t.split(",").forEach((function(t,a){if(t&&"0"!==t){var n=parseInt(t,10)-1,i=o.data[n]||{},r=n%m*w,l=Math.floor(n/m)*w;L({texture:o.texture,map:s,tileX:r,tileY:l,x:a,y:e,tileSize:w,object:i})}}))})),b.forEach((function(t){var e=parseInt(t.id,10)-1,a=e%m*w,n=Math.floor(e/m)*w;L({texture:o.texture,map:s,tileX:a,tileY:n,x:t.x/w,y:t.y/w,tileSize:w,object:Object(f.a)({},o.data[e]||{},{},t)})})),o.map[n+r]=s;case 16:o.camera.removeChildren(),o.camera.addChild(s),e&&(o.game.player.position=e);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return t.app.stage.addChildAt(o.camera,0),t.app.ticker.add(s),o}(t)}function U(t){return C.apply(this,arguments)}function C(){return(C=Object(r.a)(i.a.mark((function t(e){var a,n,r,l,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=function(t){var e=t.detail;if(r.enableControls)switch(r.action=e,r.action){case o.a.UP:case o.a.LEFT:case o.a.RIGHT:case o.a.DOWN:r.player.walk(r.action);break;default:r.player.still()}},a=e.view,n=e.setMessage,r={setMessage:n,app:null,action:null,player:null,world:null,enableControls:!1},t.next=5,u.getItem("position");case 5:return t.t0=t.sent,t.next=8,u.getItem("location");case 8:return t.t1=t.sent,t.next=11,u.getItem("layer");case 11:t.t2=t.sent,l={position:t.t0,location:t.t1,layer:t.t2},T(r,a),l.position?(r.player.position=l.position,r.world.location=l.location,r.world.layer=l.layer):(Object(p.a)("welcome",n),r.player.position={x:3*o.b,y:7*o.b},r.world.location="PalletTownRooms",r.world.layer="house1 f2"),r.world.load(),window.addEventListener("action",s);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=4.57780bbb.chunk.js.map