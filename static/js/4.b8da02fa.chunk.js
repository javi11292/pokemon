(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{141:function(t,e,a){t.exports=a.p+"static/media/characters.111f6faf.png"},142:function(t,e,a){t.exports=a.p+"static/media/world.74af39e9.png"},143:function(t,e,a){t.exports=a.p+"static/media/world.db6fb586.xml"},144:function(t,e,a){var n={"./PalletTown.xml":[145,5],"./PalletTownRooms.xml":[146,6]};function i(t){if(!a.o(n,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],i=e[0];return a.e(e[1]).then((function(){return a.t(i,7)}))}i.keys=function(){return Object.keys(n)},i.id=144,t.exports=i},147:function(t,e,a){"use strict";a.r(e),a.d(e,"createGame",(function(){return U}));var n=a(24),i=a.n(n),r=a(37),o=a(123),l=a(12),s=a(127),c=a.n(s),u=c.a.createInstance({storeName:"player"}),p=a(51),d=a(10),f=a(49),x=a(36),w={PLAYER:[6,14]};function m(t){return{x:t%8*16,y:16*Math.floor(t/8),w:16,h:16}}var h=a(141),y=a.n(h),b="still",g="walk";function v(t,e){return t.data.animations[e].map((function(e){var a,n=t.textures[e];return n.rotate=null!==(a=t.data.frames[e].rotate)&&void 0!==a?a:n.rotate,n}))}function k(t,e){var a=c.a.createInstance({name:e}),n=function(t){var e=0,a=0,n={get x(){return e},set x(a){e=a,t.setItem("position",Object(f.a)({},n,{x:e}))},get y(){return a},set y(e){a=e,t.setItem("position",Object(f.a)({},n,{y:a}))}};return n}(a),i={game:t,still:function(){i.nextState=b},face:r,walk:function(t){r(t),i.nextState=g},sprite:null,state:b,direction:l.a.DOWN,speed:{x:0,y:0},nextDirection:null,nextState:null,nextTile:{data:{}},get position(){return n},set position(t){n.x=t.x,n.y=t.y,a.setItem("position",t)},textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function r(t){i.nextDirection=t}function s(t,e){if(i.speed[t]){var a=i.speed[t]*l.c;if(i.position[t]%l.b||e)i.position[t]+=a;else{i.speed[t]=0,u();var n=i.nextTile.data;if(n.location||n.layer){var r=n.position.split(","),o=Object(d.a)(r,2),s=o[0],c=o[1];i.game.world.setLocation(n.location,n.layer,{x:s*l.b,y:c*l.b+l.b})}}}}function u(){i.nextDirection&&(i.direction=i.nextDirection,i.nextDirection=null),i.nextState&&(i.state=i.nextState,i.nextState=null)}return(new o.e).add("characters",y.a).load((function(t,a){var n=new o.g(a.characters.texture,function(t){var e=Object(d.a)(t,2),a=e[0],n=8*e[1]+a;return{meta:{},frames:{stillDown:{frame:m(n)},stillUp:{frame:m(n+1)},stillLeft:{frame:m(n+2)},stillRight:Object(x.a)({frame:m(n+2)},"rotate",o.h.MIRROR_HORIZONTAL),walkDown0:{frame:m(n+3)},walkDown1:Object(x.a)({frame:m(n+3)},"rotate",o.h.MIRROR_HORIZONTAL),walkUp0:{frame:m(n+4)},walkUp1:Object(x.a)({frame:m(n+4)},"rotate",o.h.MIRROR_HORIZONTAL),walkLeft:{frame:m(n+5)},walkRight:Object(x.a)({frame:m(n+5)},"rotate",o.h.MIRROR_HORIZONTAL)},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}}}(w[e.toUpperCase()]));n.parse((function(){i.textures.stillDown=[n.textures.stillDown],i.textures.stillUp=[n.textures.stillUp],i.textures.stillLeft=[n.textures.stillLeft],i.textures.stillRight=[n.textures.stillRight],i.textures.walkDown=v(n,"walkDown"),i.textures.walkUp=v(n,"walkUp"),i.textures.walkLeft=v(n,"walkLeft"),i.textures.walkRight=v(n,"walkRight");var t=new o.a(i.textures[i.state+Object(p.d)(i.direction)]);t.width=l.b,t.height=l.b,t.animationSpeed=.1,t.x=i.game.app.screen.width/2-t.width/2,t.y=i.game.app.screen.height/2-t.height/2,i.sprite=t,i.game.app.stage.addChild(t)}))})),i.game.app.ticker.add((function(){var t=i.direction===l.a.RIGHT?1:i.direction===l.a.LEFT?-1:0,e=i.direction===l.a.DOWN?1:i.direction===l.a.UP?-1:0;i.state!==g||i.speed.x||i.speed.y||function(t,e){var a=Math.floor(i.position.x/l.b+t),n=Math.floor(i.position.y/l.b+e);if(i.nextTile.x===a&&i.nextTile.y===n)return;i.nextTile={x:a,y:n,data:i.game.world.tileAt(a,n)}}(t,e),i.state!==g||i.speed.x||i.speed.y||"false"!==i.nextTile.data.collision?i.speed.x||i.speed.y?s(i.speed.x?"x":"y"):u():(i.speed.x=t,i.speed.y=e,s(i.speed.x?"x":"y",!0)),function(){if(!i.sprite)return;var t=i.textures[i.state+Object(p.d)(i.direction)];if(!t||i.sprite.textures===t)return;i.sprite.textures=t,i.sprite.play()}()})),i}var O=a(142),R=a.n(O),D=a(143),j=a.n(D);function I(){return new Promise((function(t){(new o.e).add("world",R.a).load((function(e,a){t(a.world.texture)}))}))}function L(t){var e=t.texture,a=t.map,n=t.tileX,i=t.tileY,r=t.x,s=t.y,c=t.object,u=t.tileSize,p=new o.d;p.name="".concat(r,"-").concat(s),p.data=c,p.beginTextureFill({texture:e}),p.drawRect(n,i,u,u),p.width=l.b,p.height=l.b,p.x=-n*p.scale.x+r*l.b,p.y=-i*p.scale.y+s*l.b,a.addChild(p)}function T(t,e){o.j.skipHello(),o.i.SCALE_MODE=o.f.NEAREST,t.app=new o.b({view:e,width:1920,height:1080}),t.app.renderer.plugins.accessibility.destroy(),delete t.app.renderer.plugins.accesibility,t.player=function(t){var e=k(t,"player"),a=e.walk,n=e.face,i=e.still;e.still=function(){i(),clearTimeout(r)},e.face=o,e.walk=l;var r=null;function o(t){n(t),r=setTimeout((function(){return l(t)}),30)}function l(t){e.direction!==t&&e.state!==g?o(t):a(t)}return e}(t),t.world=function(t){var e=null,n=null,l={game:t,update:s,tileAt:function(t,e){var a;return l.camera.children.length&&(null===(a=l.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(e)))||void 0===a?void 0:a.data)||{}},setLocation:function(t,e,a){l.location=t||l.location,l.layer=e||"index",u.setItem("location",l.location),u.setItem("layer",l.layer),x(a)},load:function(){return c.apply(this,arguments)},get location(){return e},set location(t){e=t,u.setItem("location",t)},get layer(){return n},set layer(t){n=t,u.setItem("layer",t)},texture:null,data:null,map:{},camera:new o.c};function s(){var t,e,a=l.game.player.position;l.camera.pivot.x=-(null===(t=l.game.player.sprite)||void 0===t?void 0:t.x),l.camera.pivot.y=-(null===(e=l.game.player.sprite)||void 0===e?void 0:e.y),l.camera.position.x=-a.x,l.camera.position.y=-a.y}function c(){return(c=Object(r.a)(i.a.mark((function t(){var e,a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([I(),Object(p.b)(j.a)]);case 2:return e=t.sent,a=Object(d.a)(e,2),n=a[0],r=a[1],l.texture=n,l.data=r,t.next=10,x();case 10:l.game.enableControls=!0;case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t){return w.apply(this,arguments)}function w(){return(w=Object(r.a)(i.a.mark((function t(e){var n,r,s,c,u,d,x,w,m,h,y,b;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=l.location,r=l.layer,s=l.map[n+r]){t.next=16;break}return s=new o.c,t.next=6,a(144)("./".concat(n,".xml"));case 6:return c=t.sent,u=c.default,t.next=10,Object(p.c)(u);case 10:d=t.sent,x=l.data,w=x.tileSize,m=x.columns,h=d[r],y=h.value,b=h.objects,y.split("\n").forEach((function(t,e){return t.split(",").forEach((function(t,a){if(t&&"0"!==t){var n=parseInt(t,10)-1,i=l.data[n]||{},r=n%m*w,o=Math.floor(n/m)*w;L({texture:l.texture,map:s,tileX:r,tileY:o,x:a,y:e,tileSize:w,object:i})}}))})),b.forEach((function(t){var e=parseInt(t.id,10)-1,a=e%m*w,n=Math.floor(e/m)*w;L({texture:l.texture,map:s,tileX:a,tileY:n,x:t.x/w,y:t.y/w,tileSize:w,object:Object(f.a)({},l.data[e]||{},{},t)})})),l.map[n+r]=s;case 16:l.camera.removeChildren(),l.camera.addChild(s),e&&(l.game.player.position=e);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return t.app.stage.addChildAt(l.camera,0),t.app.ticker.add(s),l}(t)}function U(t){return C.apply(this,arguments)}function C(){return(C=Object(r.a)(i.a.mark((function t(e){var a,n,r,o,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=function(t){var e=t.detail;if(r.enableControls)switch(r.action=e,r.action){case l.a.UP:case l.a.LEFT:case l.a.RIGHT:case l.a.DOWN:r.player.walk(r.action);break;default:r.player.still()}},a=e.view,n=e.setMessage,r={setMessage:n,app:null,action:null,player:null,world:null,enableControls:!1},t.next=5,u.getItem("position");case 5:return t.t0=t.sent,t.next=8,u.getItem("location");case 8:return t.t1=t.sent,t.next=11,u.getItem("layer");case 11:t.t2=t.sent,o={position:t.t0,location:t.t1,layer:t.t2},T(r,a),o.position?(r.player.position=o.position,r.world.location=o.location,r.world.layer=o.layer):(Object(p.a)("welcome",n),r.player.position={x:3*l.b,y:7*l.b},r.world.location="PalletTownRooms",r.world.layer="house1 f2"),r.world.load(),window.addEventListener("action",s);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=4.b8da02fa.chunk.js.map