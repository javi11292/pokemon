(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[6],{126:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var a=n(129),r=n.n(a),i=r.a.createInstance({name:"player"});function o(t){return r.a.createInstance({name:"events",storeName:t})}},143:function(t,e,n){t.exports=n.p+"static/media/characters.111f6faf.png"},144:function(t,e,n){t.exports=n.p+"static/media/world.74af39e9.png"},145:function(t,e,n){t.exports=n.p+"static/media/world.db6fb586.xml"},146:function(t,e,n){var a={"./PalletTown":[123,9,0],"./PalletTown/":[123,9,0],"./PalletTown/index":[123,9,0],"./PalletTown/index.js":[123,9,0],"./welcome.txt":[89,7,1]};function r(t){if(!n.o(a,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[t],r=e[0];return n.e(e[2]).then((function(){return n.t(r,e[1])}))}r.keys=function(){return Object.keys(a)},r.id=146,t.exports=r},147:function(t,e,n){var a={"./PalletTown.xml":[148,7],"./PalletTownRooms.xml":[149,8]};function r(t){if(!n.o(a,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[t],r=e[0];return n.e(e[1]).then((function(){return n.t(r,7)}))}r.keys=function(){return Object.keys(a)},r.id=147,t.exports=r},150:function(t,e,n){"use strict";n.r(e),n.d(e,"createGame",(function(){return U}));var a=n(23),r=n.n(a),i=n(36),o=n(124),l=n(12),c=n(126),s=n(51),u=n(10),p=n(49),f=n(129),d=n.n(f),x=n(37),w={PLAYER:[6,14]};function m(t){return{x:t%8*16,y:16*Math.floor(t/8),w:16,h:16}}var h=n(143),y=n.n(h),b="still",v="walk";function k(t,e){return t.data.animations[e].map((function(e){var n,a=t.textures[e];return a.rotate=null!==(n=t.data.frames[e].rotate)&&void 0!==n?n:a.rotate,a}))}function g(t,e){var n=d.a.createInstance({name:e}),a=function(t){var e=0,n=0,a={get x(){return e},set x(n){e=n,t.setItem("position",Object(p.a)({},a,{x:e}))},get y(){return n},set y(e){n=e,t.setItem("position",Object(p.a)({},a,{y:n}))}};return a}(n),c={database:n,game:t,still:function(){c.nextState=b},face:f,walk:function(t){f(t),c.nextState=v},sprite:null,state:b,direction:l.a.DOWN,speed:{x:0,y:0},nextDirection:null,nextState:null,nextTile:{data:{}},get position(){return a},set position(t){a.x=t.x,a.y=t.y},textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function f(t){c.nextDirection=t}function h(){return(h=Object(i.a)(r.a.mark((function t(){var e,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=c.direction===l.a.RIGHT?1:c.direction===l.a.LEFT?-1:0,n=c.direction===l.a.DOWN?1:c.direction===l.a.UP?-1:0,c.state!==v||c.speed.x||c.speed.y){t.next=5;break}return t.next=5,g(e,n);case 5:c.state!==v||c.speed.x||c.speed.y||"false"!==c.nextTile.data.collision?c.speed.x||c.speed.y?R(c.speed.x?"x":"y"):j():(c.speed.x=e,c.speed.y=n,R(c.speed.x?"x":"y",!0)),D();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t,e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(r.a.mark((function t(n,a){var i,o,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Math.floor(c.position.x/l.b+n),o=Math.floor(c.position.y/l.b+a),c.nextTile.x!==i||c.nextTile.y!==o){t.next=4;break}return t.abrupt("return");case 4:if(s=c.game.world.tileAt(i,o),c.nextTile={x:i,y:o,data:c.game.world.tileAt(i,o)},s.event!==e){t.next=9;break}return t.next=9,T(i,o);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(t,e){if(c.speed[t]){var n=c.speed[t]*l.c;if(c.position[t]%l.b||e)c.position[t]+=n;else{c.speed[t]=0,j();var a=c.nextTile.data;if(a.location||a.layer){var r=a.position.split(","),i=Object(u.a)(r,2),o=i[0],s=i[1];c.game.world.setLocation(a.location,a.layer,{x:o*l.b,y:s*l.b})}}}}function j(){c.nextDirection&&(c.direction=c.nextDirection,c.nextDirection=null),c.nextState&&(c.state=c.nextState,c.nextState=null)}function D(){if(c.sprite){var t=c.textures[c.state+Object(s.d)(c.direction)];t&&c.sprite.textures!==t&&(c.sprite.textures=t,c.sprite.play())}}function T(t,e){return L.apply(this,arguments)}function L(){return(L=Object(i.a)(r.a.mark((function n(a,i){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.world.events[e]["".concat(a,"-").concat(i)](c.game);case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(new o.e).add("characters",y.a).load((function(t,n){var a=new o.g(n.characters.texture,function(t){var e=Object(u.a)(t,2),n=e[0],a=8*e[1]+n;return{meta:{},frames:{stillDown:{frame:m(a)},stillUp:{frame:m(a+1)},stillLeft:{frame:m(a+2)},stillRight:Object(x.a)({frame:m(a+2)},"rotate",o.i.MIRROR_HORIZONTAL),walkDown0:{frame:m(a+3)},walkDown1:Object(x.a)({frame:m(a+3)},"rotate",o.i.MIRROR_HORIZONTAL),walkUp0:{frame:m(a+4)},walkUp1:Object(x.a)({frame:m(a+4)},"rotate",o.i.MIRROR_HORIZONTAL),walkLeft:{frame:m(a+5)},walkRight:Object(x.a)({frame:m(a+5)},"rotate",o.i.MIRROR_HORIZONTAL)},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}}}(w[e.toUpperCase()]));a.parse((function(){c.textures.stillDown=[a.textures.stillDown],c.textures.stillUp=[a.textures.stillUp],c.textures.stillLeft=[a.textures.stillLeft],c.textures.stillRight=[a.textures.stillRight],c.textures.walkDown=k(a,"walkDown"),c.textures.walkUp=k(a,"walkUp"),c.textures.walkLeft=k(a,"walkLeft"),c.textures.walkRight=k(a,"walkRight");var t=new o.a(c.textures[c.state+Object(s.d)(c.direction)]);t.width=l.b,t.height=l.b,t.animationSpeed=.1,t.x=c.game.app.screen.width/2-t.width/2,t.y=c.game.app.screen.height/2-t.height/2,c.sprite=t,c.game.app.stage.addChild(t)}))})),c.game.app.ticker.add((function(){return h.apply(this,arguments)}),null,o.h.LOW),c}var O=n(144),R=n.n(O),j=n(145),D=n.n(j);function T(){return new Promise((function(t){(new o.e).add("world",R.a).load((function(e,n){t(n.world.texture)}))}))}function L(t){var e=t.texture,n=t.map,a=t.tileX,r=t.tileY,i=t.x,c=t.y,s=t.object,u=t.tileSize,p=new o.d;p.name="".concat(i,"-").concat(c),p.data=s,p.beginTextureFill({texture:e}),p.drawRect(a,r,u,u),p.width=l.b,p.height=l.b,p.x=-a*p.scale.x+i*l.b,p.y=-r*p.scale.y+c*l.b,n.addChild(p)}function I(t,e){o.k.skipHello(),o.j.SCALE_MODE=o.f.NEAREST,t.app=new o.b({view:e,width:1920,height:1080}),t.app.renderer.plugins.accessibility.destroy(),delete t.app.renderer.plugins.accesibility,t.player=function(t){var e=g(t,"player"),n=e.walk,a=e.face,r=e.still;e.still=function(){r(),clearTimeout(i)},e.face=o,e.walk=l;var i=null;function o(t){a(t),i=setTimeout((function(){return l(t)}),50)}function l(t){e.direction!==t&&e.state!==v?o(t):n(t)}return e}(t),t.world=function(t){var e=null,a=null,l={game:t,update:f,tileAt:function(t,e){var n;return l.camera.children.length&&(null===(n=l.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(e)))||void 0===n?void 0:n.data)||{}},setLocation:function(t,e,n){l.location=t||l.location,l.layer=e||"index",c.b.setItem("location",l.location),c.b.setItem("layer",l.layer),x(n)},load:function(){return d.apply(this,arguments)},events:null,get location(){return e},set location(t){e=t,c.b.setItem("location",t)},get layer(){return a},set layer(t){a=t,c.b.setItem("layer",t)},texture:null,data:null,map:{},camera:new o.c};function f(){var t,e,n=l.game.player.position;l.camera.pivot.x=-(null===(t=l.game.player.sprite)||void 0===t?void 0:t.x),l.camera.pivot.y=-(null===(e=l.game.player.sprite)||void 0===e?void 0:e.y),l.camera.position.x=-n.x,l.camera.position.y=-n.y}function d(){return(d=Object(i.a)(r.a.mark((function t(){var e,n,a,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([T(),Object(s.b)(D.a)]);case 2:return e=t.sent,n=Object(u.a)(e,2),a=n[0],i=n[1],l.texture=a,l.data=i,t.next=10,x();case 10:l.game.enableControls=!0;case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t){return w.apply(this,arguments)}function w(){return(w=Object(i.a)(r.a.mark((function t(e){var a,i,c,u,f,d,x,w,m,h,y,b,v,k;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=l.location,i=l.layer,c=l.map[a+i],u=n(146)("./".concat(l.location,"/").concat(l.layer)).catch((function(){return{}})),c){t.next=17;break}return c=new o.c,t.next=7,n(147)("./".concat(a,".xml"));case 7:return f=t.sent,d=f.default,t.next=11,Object(s.c)(d);case 11:x=t.sent,w=l.data,m=w.tileSize,h=w.columns,y=x[i],b=y.value,v=y.objects,b.trim().split("\n").forEach((function(t,e){return t.split(",").forEach((function(t,n){if(t&&"0"!==t){var a=parseInt(t,10)-1,r=l.data[a]||{},i=a%h*m,o=Math.floor(a/h)*m;L({texture:l.texture,map:c,tileX:i,tileY:o,x:n,y:e,tileSize:m,object:r})}}))})),v.forEach((function(t){var e=parseInt(t.id,10)-1,n=e%h*m,a=Math.floor(e/h)*m;L({texture:l.texture,map:c,tileX:n,tileY:a,x:t.x/m,y:t.y/m,tileSize:m,object:Object(p.a)({},l.data[e]||{},{},t)})})),l.map[a+i]=c;case 17:return t.next=19,u;case 19:k=t.sent,l.events=k,l.camera.removeChildren(),l.camera.addChild(c),e&&(l.game.player.position=e);case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return t.app.stage.addChildAt(l.camera,0),t.app.ticker.add(f),l}(t)}function U(t){return E.apply(this,arguments)}function E(){return(E=Object(i.a)(r.a.mark((function t(e){var n,a,i,o,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=function(t){var e=t.detail;if(i.enableControls)switch(i.action=e,i.action){case l.a.UP:case l.a.LEFT:case l.a.RIGHT:case l.a.DOWN:i.player.walk(i.action);break;default:i.player.still()}},n=e.view,a=e.setMessage,i={setMessage:a,app:null,action:null,player:null,world:null,enableControls:!1},t.next=5,c.b.getItem("position");case 5:return t.t0=t.sent,t.next=8,c.b.getItem("location");case 8:return t.t1=t.sent,t.next=11,c.b.getItem("layer");case 11:t.t2=t.sent,o={position:t.t0,location:t.t1,layer:t.t2},I(i,n),o.position?(i.player.position=o.position,i.world.location=o.location,i.world.layer=o.layer):(Object(s.a)("welcome",a),i.player.position={x:3*l.b,y:6*l.b},i.world.location="PalletTownRooms",i.world.layer="house1 f2"),i.world.load(),window.addEventListener("action",u);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=6.e436624a.chunk.js.map