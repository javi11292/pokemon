(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{141:function(t,e,a){t.exports=a.p+"static/media/characters.111f6faf.png"},142:function(t,e,a){t.exports=a.p+"static/media/world.74af39e9.png"},143:function(t,e,a){t.exports=a.p+"static/media/world.db6fb586.xml"},144:function(t,e,a){var n={"./PalletTown.xml":[145,5],"./PalletTownRooms.xml":[146,6]};function i(t){if(!a.o(n,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],i=e[0];return a.e(e[1]).then((function(){return a.t(i,7)}))}i.keys=function(){return Object.keys(n)},i.id=144,t.exports=i},147:function(t,e,a){"use strict";a.r(e),a.d(e,"createGame",(function(){return L}));var n=a(24),i=a.n(n),r=a(37),o=a(123),l=a(18),s=a(140),c=a.n(s).a.createInstance({storeName:"player"}),u=a(51),p=a(9),d=a(49),f=a(36),x={meta:{},frames:{stillDown:{frame:{x:96,y:224,w:16,h:16}},walkDown0:{frame:{x:16,y:240,w:16,h:16}},walkDown1:Object(f.a)({frame:{x:16,y:240,w:16,h:16}},"rotate",o.h.MIRROR_HORIZONTAL),stillUp:{frame:{x:112,y:224,w:16,h:16}},walkUp0:{frame:{x:32,y:240,w:16,h:16}},walkUp1:Object(f.a)({frame:{x:32,y:240,w:16,h:16}},"rotate",o.h.MIRROR_HORIZONTAL),stillLeft:{frame:{x:0,y:240,w:16,h:16}},walkLeft:{frame:{x:48,y:240,w:16,h:16}},stillRight:Object(f.a)({frame:{x:0,y:240,w:16,h:16}},"rotate",o.h.MIRROR_HORIZONTAL),walkRight:Object(f.a)({frame:{x:48,y:240,w:16,h:16}},"rotate",o.h.MIRROR_HORIZONTAL)},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}},w=a(141),m=a.n(w),h="still",y="walk";function b(t,e){return t.data.animations[e].map((function(e){var a,n=t.textures[e];return n.rotate=null!==(a=t.data.frames[e].rotate)&&void 0!==a?a:n.rotate,n}))}function g(t){var e=function(){var t=0,e=0,a={get x(){return t},set x(e){t=e,c.setItem("position",Object(d.a)({},a,{x:t}))},get y(){return e},set y(t){e=t,c.setItem("position",Object(d.a)({},a,{y:e}))}};return a}(),a={game:t,update:function(){var t=a.direction===l.a.RIGHT?1:a.direction===l.a.LEFT?-1:0,e=a.direction===l.a.DOWN?1:a.direction===l.a.UP?-1:0;a.state!==y||a.speed.x||a.speed.y||function(t,e){var n=Math.floor(a.position.x/l.b+t),i=Math.floor(a.position.y/l.b+e);if(a.nextTile.x===n&&a.nextTile.y===i)return;a.nextTile={x:n,y:i,data:a.game.world.tileAt(n,i)}}(t,e);a.state!==y||a.speed.x||a.speed.y||"false"!==a.nextTile.data.collision?a.speed.x||a.speed.y?s(a.speed.x?"x":"y"):r():(a.speed.x=t,a.speed.y=e,s(a.speed.x?"x":"y",!0));!function(){if(!a.sprite)return;var t=a.textures[a.state+Object(u.d)(a.direction)];if(!t||a.sprite.textures===t)return;a.sprite.textures=t,a.sprite.play()}()},still:n,walk:i,sprite:null,state:null,direction:l.a.DOWN,nextDirection:null,nextState:null,get position(){return e},set position(t){e.x=t.x,e.y=t.y,c.setItem("position",t)},speed:{x:0,y:0},nextTile:{data:{}},textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function n(){a.nextState=h}function i(t){a.direction===t||a.state===y?(a.nextDirection=t,a.state=y):function(t){setTimeout((function(){a.direction=t,t===a.game.action?i(t):n()}),75)}(t)}function r(){a.nextDirection&&(a.direction=a.nextDirection,a.nextDirection=null),a.nextState&&(a.state=a.nextState,a.nextState=null)}function s(t,e){if(a.speed[t]){var n=a.speed[t]*l.c,i=Math.abs(a.position[t]%l.b),o=i&&(1===a.speed[t]?i:l.b-i);if(i){var s=a.position[t]<=0?o:l.b-o;a.position[t]+=s>=l.c?n:s*a.speed[t]}else if(e)a.position[t]+=n;else{a.speed[t]=0,r();var c=a.nextTile.data;if(c.location||c.layer){var u=c.position.split(","),d=Object(p.a)(u,2),f=d[0],x=d[1];a.game.world.setLocation(c.location,c.layer,{x:f*l.b,y:x*l.b+l.b})}}}}return(new o.e).add("characters",m.a).load((function(t,e){var n=new o.g(e.characters.texture,x);n.parse((function(){a.textures.stillDown=[n.textures.stillDown],a.textures.stillUp=[n.textures.stillUp],a.textures.stillLeft=[n.textures.stillLeft],a.textures.stillRight=[n.textures.stillRight],a.textures.walkDown=b(n,"walkDown"),a.textures.walkUp=b(n,"walkUp"),a.textures.walkLeft=b(n,"walkLeft"),a.textures.walkRight=b(n,"walkRight");var t=new o.a(a.textures["still".concat(Object(u.d)(a.direction))]);t.width=l.b,t.height=l.b,t.animationSpeed=.1,t.x=a.game.app.screen.width/2-t.width/2,t.y=a.game.app.screen.height/2-t.height/2,a.sprite=t,a.game.app.stage.addChild(t)}))})),a}var v=a(142),k=a.n(v),O=a(143),R=a.n(O);function D(){return new Promise((function(t){(new o.e).add("world",k.a).load((function(e,a){t(a.world.texture)}))}))}function j(t){var e=t.texture,a=t.map,n=t.tileX,i=t.tileY,r=t.x,s=t.y,c=t.object,u=t.tileSize,p=new o.d;p.name="".concat(r,"-").concat(s),p.data=c,p.beginTextureFill({texture:e}),p.drawRect(n,i,u,u),p.width=l.b,p.height=l.b,p.x=-n*p.scale.x+r*l.b,p.y=-i*p.scale.y+s*l.b,a.addChild(p)}function I(t){var e=null,n=null,l={game:t,update:function(){var t,e,a=l.game.player.position;l.camera.pivot.x=-(null===(t=l.game.player.sprite)||void 0===t?void 0:t.x),l.camera.pivot.y=-(null===(e=l.game.player.sprite)||void 0===e?void 0:e.y),l.camera.position.x=-a.x,l.camera.position.y=-a.y},tileAt:function(t,e){var a;return l.camera.children.length&&(null===(a=l.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(e)))||void 0===a?void 0:a.data)||{}},setLocation:function(t,e,a){l.location=t||l.location,l.layer=e||"index",c.setItem("location",l.location),c.setItem("layer",l.layer),f(a)},load:function(){return s.apply(this,arguments)},get location(){return e},set location(t){e=t,c.setItem("location",t)},get layer(){return n},set layer(t){n=t,c.setItem("layer",t)},texture:null,data:null,map:{},camera:new o.c};function s(){return(s=Object(r.a)(i.a.mark((function t(){var e,a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([D(),Object(u.b)(R.a)]);case 2:return e=t.sent,a=Object(p.a)(e,2),n=a[0],r=a[1],l.texture=n,l.data=r,t.next=10,f();case 10:l.game.enableControls=!0;case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(t){return x.apply(this,arguments)}function x(){return(x=Object(r.a)(i.a.mark((function t(e){var n,r,s,c,p,f,x,w,m,h,y,b;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=l.location,r=l.layer,s=l.map[n+r]){t.next=16;break}return s=new o.c,t.next=6,a(144)("./".concat(n,".xml"));case 6:return c=t.sent,p=c.default,t.next=10,Object(u.c)(p);case 10:f=t.sent,x=l.data,w=x.tileSize,m=x.columns,h=f[r],y=h.value,b=h.objects,y.split("\n").forEach((function(t,e){return t.split(",").forEach((function(t,a){if(t&&"0"!==t){var n=parseInt(t,10)-1,i=l.data[n]||{},r=n%m*w,o=Math.floor(n/m)*w;j({texture:l.texture,map:s,tileX:r,tileY:o,x:a,y:e,tileSize:w,object:i})}}))})),b.forEach((function(t){var e=parseInt(t.id,10)-1,a=e%m*w,n=Math.floor(e/m)*w;j({texture:l.texture,map:s,tileX:a,tileY:n,x:t.x/w,y:t.y/w,tileSize:w,object:Object(d.a)({},l.data[e]||{},{},t)})})),l.map[n+r]=s;case 16:l.camera.removeChildren(),l.camera.addChild(s),e&&(l.game.player.position=e);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return t.app.stage.addChildAt(l.camera,0),l}function L(t){return T.apply(this,arguments)}function T(){return(T=Object(r.a)(i.a.mark((function t(e){var a,n,r,s,p;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=function(t){var e=t.detail;if(r.enableControls)switch(r.action=e,r.action){case l.a.UP:case l.a.LEFT:case l.a.RIGHT:case l.a.DOWN:r.player.walk(r.action);break;default:r.player.still()}},a=e.view,n=e.setMessage,r={setMessage:n,app:null,action:null,player:null,world:null,enableControls:!1},t.next=5,c.getItem("position");case 5:return t.t0=t.sent,t.next=8,c.getItem("location");case 8:return t.t1=t.sent,t.next=11,c.getItem("layer");case 11:t.t2=t.sent,s={position:t.t0,location:t.t1,layer:t.t2},o.j.skipHello(),o.i.SCALE_MODE=o.f.NEAREST,r.app=new o.b({view:a,width:1920,height:1080}),r.app.renderer.plugins.accessibility.destroy(),delete r.app.renderer.plugins.accesibility,r.player=g(r),r.world=I(r),s.position?(r.player.position=s.position,r.world.location=s.location,r.world.layer=s.layer):(Object(u.a)("welcome",n),r.player.position={x:3*l.b,y:7*l.b},r.world.location="PalletTownRooms",r.world.layer="house1 f2"),r.world.load(),window.addEventListener("action",p),r.app.ticker.add((function(){r.player.update(),r.world.update()}));case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=4.05a0d3c7.chunk.js.map