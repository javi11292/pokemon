(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{123:function(t,e,a){t.exports=a.p+"static/media/characters.111f6faf.png"},127:function(t,e,a){t.exports=a.p+"static/media/world.74af39e9.png"},128:function(t,e,a){var i={"./PalletTown.txt":[129,5]};function n(t){if(!a.o(i,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=i[t],n=e[0];return a.e(e[1]).then((function(){return a.t(n,7)}))}n.keys=function(){return Object.keys(i)},n.id=128,t.exports=n},130:function(t,e,a){"use strict";a.r(e),a.d(e,"createGame",(function(){return g}));var i=a(106),n=a(17),r={meta:{},frames:{stillDown:{frame:{x:96,y:224,w:16,h:16}},walkDown0:{frame:{x:16,y:240,w:16,h:16}},walkDown1:{frame:{x:16,y:240,w:16,h:16},rotate:i.h.MIRROR_HORIZONTAL},stillUp:{frame:{x:112,y:224,w:16,h:16}},walkUp0:{frame:{x:32,y:240,w:16,h:16}},walkUp1:{frame:{x:32,y:240,w:16,h:16},rotate:i.h.MIRROR_HORIZONTAL},stillLeft:{frame:{x:0,y:240,w:16,h:16}},walkLeft:{frame:{x:48,y:240,w:16,h:16}},stillRight:{frame:{x:0,y:240,w:16,h:16},rotate:i.h.MIRROR_HORIZONTAL},walkRight:{frame:{x:48,y:240,w:16,h:16},rotate:i.h.MIRROR_HORIZONTAL}},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}},l=a(123),o=a.n(l),s=a(46),c="still",u="walk";function p(t,e){return t.data.animations[e].map((function(e){var a,i=t.textures[e];return i.rotate=null!==(a=t.data.frames[e].rotate)&&void 0!==a?a:i.rotate,i}))}function w(t){var e={game:t,update:function(){var t=e.direction===n.a.RIGHT?1:e.direction===n.a.LEFT?-1:0,a=e.direction===n.a.DOWN?1:e.direction===n.a.UP?-1:0;e.state!==u||e.speed.x||e.speed.y||function(t,a){var i=Math.floor(e.position.x/n.b+t),r=Math.floor(e.position.y/n.b+a),l=e.position.x%n.b,o=e.position.y%n.b;if(l||o)return!!e.collision;if(!e.collision||i!==e.collision.x||r!==e.collision.y){var s=e.game.world.tileAt(i,r);!s||s.collision?e.collision={x:i,y:r}:e.collision=null}return!!e.collision}(t,a)?e.speed.x||e.speed.y?d(e.speed.x?"x":"y"):w():(e.speed.x=t,e.speed.y=a,d(e.speed.x?"x":"y",!0));!function(){if(!e.sprite)return;var t=e.textures[e.state+Object(s.a)(e.direction)];if(!t||e.sprite.textures===t)return;e.sprite.textures=t,e.sprite.play()}()},still:a,walk:l,sprite:null,state:null,direction:n.a.DOWN,nextDirection:null,position:{x:10*n.b,y:3*n.b},speed:{x:0,y:0},collision:null,textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function a(){e.state=c}function l(t){e.direction===t||e.state===u?(e.nextDirection=t,e.state=u):function(t){setTimeout((function(){e.direction=t,t===e.game.action?l(t):a()}),100)}(t)}function w(){e.nextDirection&&(e.direction=e.nextDirection,e.nextDirection=null)}function d(t,a){if(e.speed[t]){var i=e.speed[t]*n.c,r=Math.abs(e.position[t]%n.b),l=r&&(1===e.speed[t]?r:n.b-r);if(r){var o=e.position[t]<=0?l:n.b-l;e.position[t]+=o>=n.c?i:o*e.speed[t]}else a?e.position[t]+=i:(e.speed[t]=0,w())}}return(new i.e).add("characters",o.a).load((function(t,a){var l=new i.g(a.characters.texture,r);l.parse((function(){e.textures.stillDown=[l.textures.stillDown],e.textures.stillUp=[l.textures.stillUp],e.textures.stillLeft=[l.textures.stillLeft],e.textures.stillRight=[l.textures.stillRight],e.textures.walkDown=p(l,"walkDown"),e.textures.walkUp=p(l,"walkUp"),e.textures.walkLeft=p(l,"walkLeft"),e.textures.walkRight=p(l,"walkRight");var t=new i.a(e.textures["still".concat(Object(s.a)(e.direction))]);t.width=n.b,t.height=n.b,t.animationSpeed=.1,t.x=e.game.app.screen.width/2-t.width/2,t.y=e.game.app.screen.height/2-t.height/2,e.sprite=t,e.game.app.stage.addChild(t)}))})),e}var d=a(124),f=a.n(d),x=a(126),h={0:{name:"dirt",x:0,y:0,w:16,h:16},1:{name:"grass",x:32,y:16,w:16,h:16},2:{name:"wall",x:96,y:0,w:16,h:16,collision:!0},3:{name:"dirt2",x:0,y:16,w:16,h:16}},m=a(127),y=a.n(m);function k(t){var e={game:t,update:function(){var t,a,i=e.game.player.position;e.camera.pivot.x=-(null===(t=e.game.player.sprite)||void 0===t?void 0:t.x),e.camera.pivot.y=-(null===(a=e.game.player.sprite)||void 0===a?void 0:a.y),e.camera.position.x=-i.x,e.camera.position.y=-i.y},tileAt:function(t,a){if(!e.camera.children.length)return;return e.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(a))},location:null,texture:null,map:{},camera:new i.c};function r(){return(r=Object(x.a)(f.a.mark((function t(r){var l,o,s,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=e.map[r]){t.next=12;break}return t.next=4,a(128)("./".concat(r,".txt"));case 4:return o=t.sent,s=o.default,t.next=8,fetch(s).then((function(t){return t.text()}));case 8:c=t.sent,l=new i.c,c.split("\n").forEach((function(t,a){return t.split(" ").forEach((function(t,r){var o=h[t];if(o){var s=new i.d;s.name="".concat(r,"-").concat(a),s.collision=o.collision,s.beginTextureFill({texture:e.texture}),s.drawRect(o.x,o.y,o.w,o.h),s.width=n.b,s.height=n.b,s.x=-o.x*s.scale.x+r*n.b,s.y=-o.y*s.scale.y+a*n.b,l.addChild(s)}}))})),e.map[r]=l;case 12:e.camera.removeChildren(),e.camera.addChild(l);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(new i.e).add("world",y.a).load((function(t,a){e.texture=a.world.texture,function(t){r.apply(this,arguments)}("PalletTown")})),t.app.stage.addChildAt(e.camera,0),e}function g(t){i.j.skipHello(),i.i.SCALE_MODE=i.f.NEAREST;var e={app:null,action:null,player:null,world:null};e.app=new i.b({view:t,width:1920,height:1080}),e.player=w(e),e.world=k(e),window.addEventListener("action",(function(t){var a=t.detail;switch(e.action=a,e.action){case n.a.UP:case n.a.LEFT:case n.a.RIGHT:case n.a.DOWN:e.player.walk(e.action);break;default:e.player.still()}})),e.app.ticker.add((function(){e.player.update(),e.world.update()}))}}}]);
//# sourceMappingURL=4.8d265253.chunk.js.map