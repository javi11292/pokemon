(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[4],{124:function(t,e,a){t.exports=a.p+"static/media/characters.111f6faf.png"},128:function(t,e,a){t.exports=a.p+"static/media/world.74af39e9.png"},129:function(t,e,a){var n={"./PalletTown.txt":[130,5]};function i(t){if(!a.o(n,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=n[t],i=e[0];return a.e(e[1]).then((function(){return a.t(i,7)}))}i.keys=function(){return Object.keys(n)},i.id=129,t.exports=i},131:function(t,e,a){"use strict";a.r(e),a.d(e,"createGame",(function(){return R}));var n=a(106),i=a(17),r=a(110),o={meta:{},frames:{stillDown:{frame:{x:96,y:224,w:16,h:16}},walkDown0:{frame:{x:16,y:240,w:16,h:16}},walkDown1:Object(r.a)({frame:{x:16,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL),stillUp:{frame:{x:112,y:224,w:16,h:16}},walkUp0:{frame:{x:32,y:240,w:16,h:16}},walkUp1:Object(r.a)({frame:{x:32,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL),stillLeft:{frame:{x:0,y:240,w:16,h:16}},walkLeft:{frame:{x:48,y:240,w:16,h:16}},stillRight:Object(r.a)({frame:{x:0,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL),walkRight:Object(r.a)({frame:{x:48,y:240,w:16,h:16}},"rotate",n.h.MIRROR_HORIZONTAL)},animations:{walkDown:["walkDown0","stillDown","walkDown1","stillDown"],walkUp:["walkUp0","stillUp","walkUp1","stillUp"],walkLeft:["walkLeft","stillLeft"],walkRight:["walkRight","stillRight"]}},l=a(124),c=a.n(l),s=a(46),w="still",u="walk";function p(t,e){return t.data.animations[e].map((function(e){var a,n=t.textures[e];return n.rotate=null!==(a=t.data.frames[e].rotate)&&void 0!==a?a:n.rotate,n}))}function h(t){var e={game:t,update:function(){var t=e.direction===i.a.RIGHT?1:e.direction===i.a.LEFT?-1:0,a=e.direction===i.a.DOWN?1:e.direction===i.a.UP?-1:0;e.state!==u||e.speed.x||e.speed.y||function(t,a){var n=Math.floor(e.position.x/i.b+t),r=Math.floor(e.position.y/i.b+a),o=e.position.x%i.b,l=e.position.y%i.b;if(o||l)return!!e.collision;if(!e.collision||n!==e.collision.x||r!==e.collision.y){var c=e.game.world.tileAt(n,r);!c||c.collision?e.collision={x:n,y:r}:e.collision=null}return!!e.collision}(t,a)?e.speed.x||e.speed.y?h(e.speed.x?"x":"y"):l():(e.speed.x=t,e.speed.y=a,h(e.speed.x?"x":"y",!0));!function(){if(!e.sprite)return;var t=e.textures[e.state+Object(s.a)(e.direction)];if(!t||e.sprite.textures===t)return;e.sprite.textures=t,e.sprite.play()}()},still:a,walk:r,sprite:null,state:null,direction:i.a.DOWN,nextDirection:null,position:{x:10*i.b,y:3*i.b},speed:{x:0,y:0},collision:null,textures:{stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]}};function a(){e.state=w}function r(t){e.direction===t||e.state===u?(e.nextDirection=t,e.state=u):function(t){setTimeout((function(){e.direction=t,t===e.game.action?r(t):a()}),100)}(t)}function l(){e.nextDirection&&(e.direction=e.nextDirection,e.nextDirection=null)}function h(t,a){if(e.speed[t]){var n=e.speed[t]*i.c,r=Math.abs(e.position[t]%i.b),o=r&&(1===e.speed[t]?r:i.b-r);if(r){var c=e.position[t]<=0?o:i.b-o;e.position[t]+=c>=i.c?n:c*e.speed[t]}else a?e.position[t]+=n:(e.speed[t]=0,l())}}return(new n.e).add("characters",c.a).load((function(t,a){var r=new n.g(a.characters.texture,o);r.parse((function(){e.textures.stillDown=[r.textures.stillDown],e.textures.stillUp=[r.textures.stillUp],e.textures.stillLeft=[r.textures.stillLeft],e.textures.stillRight=[r.textures.stillRight],e.textures.walkDown=p(r,"walkDown"),e.textures.walkUp=p(r,"walkUp"),e.textures.walkLeft=p(r,"walkLeft"),e.textures.walkRight=p(r,"walkRight");var t=new n.a(e.textures["still".concat(Object(s.a)(e.direction))]);t.width=i.b,t.height=i.b,t.animationSpeed=.1,t.x=e.game.app.screen.width/2-t.width/2,t.y=e.game.app.screen.height/2-t.height/2,e.sprite=t,e.game.app.stage.addChild(t)}))})),e}var f,d=a(125),x=a.n(d),m=a(127),y="collision",b={0:{name:"dirt",x:0,y:0,w:16,h:16},1:{name:"grass",x:32,y:16,w:16,h:16},2:Object(r.a)({name:"wall",x:96,y:0,w:16,h:16},y,!0),3:{name:"dirt2",x:0,y:16,w:16,h:16},4:{name:"water",x:144,y:16,w:16,h:16},5:Object(r.a)({name:"waterTop",x:144,y:32,w:16,h:16},y,!0),6:Object(r.a)({name:"waterLeft",x:160,y:16,w:16,h:16},y,!0),7:Object(r.a)({name:"waterRight",x:128,y:16,w:16,h:16},y,!0),8:Object(r.a)({name:"waterTopLeft",x:160,y:0,w:16,h:16},y,!0),9:Object(r.a)({name:"waterTopRight",x:128,y:0,w:16,h:16},y,!0),a:{name:"door",x:48,y:96,w:16,h:16},b:Object(r.a)({name:"wallLeft",x:48,y:176,w:16,h:16},y,!0),c:Object(r.a)({name:"wall",x:48,y:112,w:16,h:16},y,!0),d:Object(r.a)({name:"wallRight",x:48,y:192,w:16,h:16},y,!0),e:Object(r.a)({name:"roofLeft",x:0,y:96,w:16,h:16},y,!0),f:Object(r.a)({name:"roof",x:16,y:96,w:16,h:16},y,!0),g:Object(r.a)({name:"roofRight",x:32,y:96,w:16,h:16},y,!0),h:Object(r.a)({name:"roofLeft2",x:32,y:208,w:16,h:16},y,!0),i:Object(r.a)({name:"roof2",x:48,y:208,w:16,h:16},y,!0),j:(f={name:"roofRight2",x:32,y:208,w:16,h:16},Object(r.a)(f,y,!0),Object(r.a)(f,"rotate",!0),f)},O=a(128),g=a.n(O);function k(t){var e={game:t,update:function(){var t,a,n=e.game.player.position;e.camera.pivot.x=-(null===(t=e.game.player.sprite)||void 0===t?void 0:t.x),e.camera.pivot.y=-(null===(a=e.game.player.sprite)||void 0===a?void 0:a.y),e.camera.position.x=-n.x,e.camera.position.y=-n.y},tileAt:function(t,a){if(!e.camera.children.length)return;return e.camera.getChildAt(0).getChildByName("".concat(t,"-").concat(a))},location:null,texture:null,map:{},camera:new n.c};function r(){return(r=Object(m.a)(x.a.mark((function t(r){var o,l,c,s;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.map[r]){t.next=12;break}return t.next=4,a(129)("./".concat(r,".txt"));case 4:return l=t.sent,c=l.default,t.next=8,fetch(c).then((function(t){return t.text()}));case 8:s=t.sent,o=new n.c,s.split("\n").forEach((function(t,a){return t.split(" ").forEach((function(t,r){var l=b[t];if(l){var c=new n.d;c.name="".concat(r,"-").concat(a),c.collision=l.collision,c.beginTextureFill({texture:e.texture}),c.drawRect(l.x,l.y,l.w,l.h),c.width=l.rotate?-i.b:i.b,c.height=i.b,c.x=-l.x*c.scale.x+r*i.b-(l.rotate?c.width:0),c.y=-l.y*c.scale.y+a*i.b,o.addChild(c)}}))})),e.map[r]=o;case 12:e.camera.removeChildren(),e.camera.addChild(o);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(new n.e).add("world",g.a).load((function(t,a){e.texture=a.world.texture,function(t){r.apply(this,arguments)}("PalletTown")})),t.app.stage.addChildAt(e.camera,0),e}function R(t){n.j.skipHello(),n.i.SCALE_MODE=n.f.NEAREST;var e={app:null,action:null,player:null,world:null};e.app=new n.b({view:t,width:1920,height:1080}),e.player=h(e),e.world=k(e),window.addEventListener("action",(function(t){var a=t.detail;switch(e.action=a,e.action){case i.a.UP:case i.a.LEFT:case i.a.RIGHT:case i.a.DOWN:e.player.walk(e.action);break;default:e.player.still()}})),e.app.ticker.add((function(){e.player.update(),e.world.update()}))}}}]);
//# sourceMappingURL=4.1d53293c.chunk.js.map