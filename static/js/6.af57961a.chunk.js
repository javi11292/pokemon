(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[6],{123:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c}));var a=n(37),r=n(125),i={PLAYER:118};function o(t){return{x:t%8*16,y:16*Math.floor(t/8),w:16,h:16}}function c(t){var e;return{meta:{},frames:(e={},Object(a.a)(e,"stillDown"+t,{frame:o(t)}),Object(a.a)(e,"stillUp"+t,{frame:o(t+1)}),Object(a.a)(e,"stillLeft"+t,{frame:o(t+2)}),Object(a.a)(e,"stillRight"+t,Object(a.a)({frame:o(t+2)},"rotate",r.i.MIRROR_HORIZONTAL)),Object(a.a)(e,"walkDown0"+t,{frame:o(t+3)}),Object(a.a)(e,"walkDown1"+t,Object(a.a)({frame:o(t+3)},"rotate",r.i.MIRROR_HORIZONTAL)),Object(a.a)(e,"walkUp0"+t,{frame:o(t+4)}),Object(a.a)(e,"walkUp1"+t,Object(a.a)({frame:o(t+4)},"rotate",r.i.MIRROR_HORIZONTAL)),Object(a.a)(e,"walkLeft"+t,{frame:o(t+5)}),Object(a.a)(e,"walkRight"+t,Object(a.a)({frame:o(t+5)},"rotate",r.i.MIRROR_HORIZONTAL)),e),animations:{walkDown:["walkDown0"+t,"stillDown"+t,"walkDown1"+t,"stillDown"+t],walkUp:["walkUp0"+t,"stillUp"+t,"walkUp1"+t,"stillUp"+t],walkLeft:["walkLeft"+t,"stillLeft"+t],walkRight:["walkRight"+t,"stillRight"+t]}}}},127:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c}));var a=n(130),r=n.n(a),i=n(123),o=r.a.createInstance({name:i.a.PLAYER});function c(t){return r.a.createInstance({name:"events",storeName:t})}},144:function(t,e,n){t.exports=n.p+"static/media/characters.111f6faf.png"},145:function(t,e,n){t.exports=n.p+"static/media/world.74af39e9.png"},146:function(t,e,n){t.exports=n.p+"static/media/world.db6fb586.xml"},147:function(t,e,n){var a={"./PalletTown":[124,9,0],"./PalletTown/":[124,9,0],"./PalletTown/index":[124,9,0],"./PalletTown/index.js":[124,9,0],"./welcome.txt":[89,7,1]};function r(t){if(!n.o(a,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[t],r=e[0];return n.e(e[2]).then((function(){return n.t(r,e[1])}))}r.keys=function(){return Object.keys(a)},r.id=147,t.exports=r},148:function(t,e,n){var a={"./PalletTown.xml":[149,7],"./PalletTownRooms.xml":[150,8]};function r(t){if(!n.o(a,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[t],r=e[0];return n.e(e[1]).then((function(){return n.t(r,7)}))}r.keys=function(){return Object.keys(a)},r.id=148,t.exports=r},151:function(t,e,n){"use strict";n.r(e),n.d(e,"createGame",(function(){return H}));var a=n(23),r=n.n(a),i=n(36),o=n(125),c=n(12),s=n(127),l=n(51),u=n(10),p=n(123),f=n(38),d=n(130),x=n.n(d),w=n(144),h=n.n(w),b="still",m="walk",y=null,v=null;function k(){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){(new o.e).add("characters",h.a).load((function(e,n){y=n,t()}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t,e){return t.data.animations[e].map((function(e){var n,a=t.textures[e];return a.rotate=null!==(n=t.data.frames[e].rotate)&&void 0!==n?n:a.rotate,a}))}function j(t,e,n){return R.apply(this,arguments)}function R(){return(R=Object(i.a)(r.a.mark((function t(e,n,a){var i,o,c,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getItem("position");case 2:return i=t.sent,o=(null===i||void 0===i?void 0:i.x)||n,c=(null===i||void 0===i?void 0:i.y)||a,s={get x(){return o},set x(t){o=t,e.setItem("position",Object(f.a)({},s,{x:o}))},get y(){return c},set y(t){c=t,e.setItem("position",Object(f.a)({},s,{y:c}))}},t.abrupt("return",s);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t,e,n,a,r){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(r.a.mark((function t(e,n,a,s,u){var f,d,w,h,O,R,T,D,I,L,U,E,P,S,N,M,A;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(A=function(){return(A=Object(i.a)(r.a.mark((function t(a,i){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.world.events[n]["".concat(a,"-").concat(i)](w.game);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},M=function(t,e){return A.apply(this,arguments)},N=function(){var t=new o.g(y.characters.texture,Object(p.b)(n));t.parse((function(){w.textures.stillDown=[t.textures["stillDown"+n]],w.textures.stillUp=[t.textures["stillUp"+n]],w.textures.stillLeft=[t.textures["stillLeft"+n]],w.textures.stillRight=[t.textures["stillRight"+n]],w.textures.walkDown=g(t,"walkDown"),w.textures.walkUp=g(t,"walkUp"),w.textures.walkLeft=g(t,"walkLeft"),w.textures.walkRight=g(t,"walkRight");var e=new o.a(w.textures[w.state+Object(l.d)(w.direction)]);e.width=c.b,e.height=c.b,e.animationSpeed=.1,e.x=s,e.y=u,w.sprite=e,a.addChild(e)}))},S=function(){if(w.sprite){var t=w.textures[w.state+Object(l.d)(w.direction)];t&&w.sprite.textures!==t&&(w.sprite.textures=t,w.sprite.play())}},P=function(){w.nextDirection&&(w.direction=w.nextDirection,w.nextDirection=null),w.nextState&&(w.state=w.nextState,w.nextState=null)},E=function(t,e){if(w.speed[t]){var n=w.speed[t]*c.c;d[t]%c.b||e?d[t]+=n:(w.speed[t]=0,w.updateState())}},U=function(){return(U=Object(i.a)(r.a.mark((function t(e,a){var i,o,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Math.floor(d.x/c.b+e),o=Math.floor(d.y/c.b+a),w.nextTile.x!==i||w.nextTile.y!==o){t.next=4;break}return t.abrupt("return");case 4:if(s=w.game.world.tileAt(i,o),w.nextTile={x:i,y:o,data:s},s.event!==n.toString()){t.next=9;break}return t.next=9,M(i,o);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)},L=function(t,e){return U.apply(this,arguments)},I=function(){w.sprite.x=d.x,w.sprite.y=d.y},D=function(){return(D=Object(i.a)(r.a.mark((function t(){var e,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=w.direction===c.a.RIGHT?1:w.direction===c.a.LEFT?-1:0,n=w.direction===c.a.DOWN?1:w.direction===c.a.UP?-1:0,w.state!==m||w.speed.x||w.speed.y){t.next=5;break}return t.next=5,L(e,n);case 5:w.state!==m||w.speed.x||w.speed.y||"false"!==w.nextTile.data.collision?w.speed.x||w.speed.y?E(w.speed.x?"x":"y"):P():(w.speed.x=e,w.speed.y=n,E(w.speed.x?"x":"y",!0)),S(),w.postUpdate&&w.postUpdate();case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)},T=function(){return D.apply(this,arguments)},R=function(t){O(t),w.nextState=m},O=function(t){w.nextDirection=t},h=function(){w.nextState=b},y||v){t.next=18;break}return t.next=17,k();case 17:v=t.sent;case 18:return f=x.a.createInstance({name:n}),t.next=21,j(f,s,u);case 21:return d=t.sent,t.t0=f,t.t1=e,t.t2=h,t.t3=O,t.t4=R,t.t5=P,t.t6=I,t.t7=b,t.t8=c.a.DOWN,t.t9={x:0,y:0},t.t10={data:{}},t.t11={stillDown:[],stillUp:[],stillLeft:[],stillRight:[],walkDown:[],walkUp:[],walkLeft:[],walkRight:[]},w={database:t.t0,game:t.t1,still:t.t2,face:t.t3,walk:t.t4,updateState:t.t5,postUpdate:t.t6,sprite:null,state:t.t7,direction:t.t8,speed:t.t9,nextDirection:null,nextState:null,nextTile:t.t10,get position(){return d},set position(t){d.x=t.x,d.y=t.y},textures:t.t11},N(),w.game.app.ticker.add(T),t.abrupt("return",w);case 38:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t){return L.apply(this,arguments)}function L(){return(L=Object(i.a)(r.a.mark((function t(e){var n,a,i,o,s,l,f,d,x,w;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return w=function(){s();var t=n.nextTile.data;if(t.location||t.layer){var a=t.position.split(","),r=Object(u.a)(a,2),i=r[0],o=r[1];e.world.setLocation(t.location,t.layer,{x:i*c.b,y:o*c.b})}},x=function(t){n.direction!==t&&n.state!==m?d(t):a(t)},d=function(t){i(t),l=setTimeout((function(){return x(t)}),50)},f=function(){o(),clearTimeout(l)},t.next=6,T(e,p.a.PLAYER,e.app.stage,e.app.screen.width/2-c.b/2,e.app.screen.height/2-c.b/2);case 6:return n=t.sent,a=n.walk,i=n.face,o=n.still,s=n.updateState,n.still=f,n.face=d,n.walk=x,n.updateState=w,n.postUpdate=null,l=null,t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var U=n(145),E=n.n(U),P=n(146),S=n.n(P);function N(){return new Promise((function(t){(new o.e).add("world",E.a).load((function(e,n){t(n.world.texture)}))}))}function M(t){var e=t.texture,n=t.map,a=t.tileX,r=t.tileY,i=t.x,s=t.y,l=t.tileSize,u=new o.d;u.beginTextureFill({texture:e}),u.drawRect(a,r,l,l),u.width=c.b,u.height=c.b,u.x=-a*u.scale.x+i*c.b,u.y=-r*u.scale.y+s*c.b,n.addChild(u)}function A(t){var e=null,a=null,p={game:t,update:d,tileAt:function(t,n){return p.tiles[e+a]&&p.tiles[e+a]["".concat(t,"-").concat(n)]||{}},setLocation:function(t,e,n){p.location=t||p.location,p.layer=e||"index",s.b.setItem("location",p.location),s.b.setItem("layer",p.layer),w(n)},load:function(){return x.apply(this,arguments)},events:null,get location(){return e},set location(t){e=t,s.b.setItem("location",t)},get layer(){return a},set layer(t){a=t,s.b.setItem("layer",t)},texture:null,data:null,map:{},tiles:{},characters:{},camera:new o.c};function d(){var t,e,n=p.game.player.position;p.camera.pivot.x=-(null===(t=p.game.player.sprite)||void 0===t?void 0:t.x),p.camera.pivot.y=-(null===(e=p.game.player.sprite)||void 0===e?void 0:e.y),p.camera.position.x=-n.x,p.camera.position.y=-n.y}function x(){return(x=Object(i.a)(r.a.mark((function t(){var e,n,a,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([N(),Object(l.b)(S.a)]);case 2:return e=t.sent,n=Object(u.a)(e,2),a=n[0],i=n[1],p.texture=a,p.data=i,t.next=10,w();case 10:p.game.enableControls=!0;case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(t){return h.apply(this,arguments)}function h(){return(h=Object(i.a)(r.a.mark((function t(e){var a,s,u,d,x,w,h,b,m,y,v,k,O,g,j,R,D,I;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n(147)("./".concat(p.location,"/").concat(p.layer)).catch((function(){return{default:{}}})),s=p.location,u=p.layer,d=p.map[s+u],x=p.tiles[s+u],w=p.characters[s+u],d){t.next=26;break}return d=new o.c,x={},w=[],t.next=11,n(148)("./".concat(s,".xml"));case 11:return h=t.sent,b=h.default,t.next=15,Object(l.c)(b);case 15:return m=t.sent,y=p.data,v=y.tileSize,k=y.columns,O=m[u],g=O.value,j=O.objects,R=[],g.split("\n").forEach((function(t,e){return t.split(",").forEach((function(t,n){if(t&&"0"!==t){var a=parseInt(t,10)-m.gids.world,r=p.data[a]||{},i=a%k*v,o=Math.floor(a/k)*v;x["".concat(n,"-").concat(e)]=r,M({texture:p.texture,map:d,tileX:i,tileY:o,x:n,y:e,tileSize:v})}}))})),j.forEach(function(){var t=Object(i.a)(r.a.mark((function t(e){var n,a,i,o,s,l;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m.gids.characters&&!(e.id<m.gids.characters)){t.next=8;break}n=e.id-m.gids.world,a=n%k*v,i=Math.floor(n/k)*v,x["".concat(e.x/v,"-").concat(e.y/v)]=Object(f.a)({},p.data[n]||{},{},e),M({texture:p.texture,map:d,tileX:a,tileY:i,x:e.x/v,y:e.y/v,tileSize:v}),t.next=16;break;case 8:return o=e.id-m.gids.characters,s=T(p.game,o,d,c.b*e.x/v,c.b*e.y/v),R.push(s),t.next=13,s;case 13:l=t.sent,w.push(l),l.sprite.visible="false"!==e.visible;case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=23,Promise.all(R);case 23:p.map[s+u]=d,p.tiles[s+u]=x,p.characters[s+u]=w;case 26:return t.next=28,a;case 28:D=t.sent,I=D.default,p.events=I,p.camera.removeChildren(),p.camera.addChild(d),e&&(p.game.player.position=e);case 34:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return t.app.stage.addChildAt(p.camera,0),t.app.ticker.add(d,null,o.h.INTERACTION),p}function C(t,e){return _.apply(this,arguments)}function _(){return(_=Object(i.a)(r.a.mark((function t(e,n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o.k.skipHello(),o.j.SCALE_MODE=o.f.NEAREST,e.app=new o.b({view:n,width:1920,height:1080}),e.app.renderer.plugins.accessibility.destroy(),delete e.app.renderer.plugins.accesibility,t.next=7,I(e);case 7:e.player=t.sent,e.world=A(e);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function H(t){return Y.apply(this,arguments)}function Y(){return(Y=Object(i.a)(r.a.mark((function t(e){var n,a,i,o,u;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=function(t){var e=t.detail;if(i.enableControls)switch(i.action=e,i.action){case c.a.UP:case c.a.LEFT:case c.a.RIGHT:case c.a.DOWN:i.player.walk(i.action);break;default:i.player.still()}},n=e.view,a=e.setMessage,i={setMessage:a,app:null,action:null,player:null,world:null,enableControls:!1},t.next=5,s.b.getItem("position");case 5:return t.t0=t.sent,t.next=8,s.b.getItem("location");case 8:return t.t1=t.sent,t.next=11,s.b.getItem("layer");case 11:return t.t2=t.sent,o={position:t.t0,location:t.t1,layer:t.t2},t.next=15,C(i,n);case 15:o.position?(i.world.location=o.location,i.world.layer=o.layer):(Object(l.a)("welcome",a),i.player.position={x:3*c.b,y:6*c.b},i.world.location="PalletTownRooms",i.world.layer="house1 f2"),i.world.load(),window.addEventListener("action",u);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=6.af57961a.chunk.js.map